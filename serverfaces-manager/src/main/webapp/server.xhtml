
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:sf="http://serverfaces.org/ui"
                template="templates/main.xhtml">

    <ui:define name="content">
        <p:tooltip for="addServerInpTxr"  value="{ip address}/{port} - example: localhost/16112"/>  
        <h:panelGrid columns="3" style="margin: 10px; width: 400px" cellpadding="0" cellspacing="0">
            <p:outputLabel for="addServerInpTxr" value="Agent Address:"/>
            <p:inputText autocomplete="true" id="addServerInpTxr" value="#{managerMBean.agentAddress}" required="true" requiredMessage="The agent address is required"/>
            <p:commandButton value="Add new server..." icon="ui-icon server" action="#{managerMBean.addServer}" update="mainForm:monitoringPanel #{g}"  style="margin-left: 3px" onclick="blocker.show()" oncomplete="blocker.hide()"/>
        </h:panelGrid>
        
        <p:outputPanel layout="block" id="monitoringPanel">
           
            <h:panelGrid columns="2" rendered="#{not empty managerMBean.servers}">
            <ui:repeat var="s" value="#{managerMBean.servers}">
                  <p:panel  header="#{s.info.name}" style="width: 370px;overflow: auto;font-size: 11px" styleClass="monitoringPanel ui-panel-title" >
                     <f:facet name="actions">  
                         <p:commandLink styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default" action="#{managerMBean.doServerMoniring(s)}" >  
                            <h:outputText styleClass="ui-icon ui-icon-help" />  
                        </p:commandLink>  
                    </f:facet>  
                        <h:panelGrid columnClasses="label,form" columns="2" style="text-align: right;">
                            <h:outputLabel for="agent" value="Agent:" style="font-weight: bold"/>
                            <h:outputText id="agent" value="#{s.agentAddress}"/>
                            <h:outputLabel for="uptime" value="Uptime:" style="font-weight: bold"/>
                            <h:outputText id="uptime" value="#{s.info.uptime}"/>
                            <h:outputLabel for="sessions" value=" Active Sessions:" style="font-weight: bold"/>
                            <h:outputText id="sessions" value="#{s.info.activeSessions}"/>
                            <h:outputLabel for="usedMemory" value="Used Memory:" style="font-weight: bold"/>
                            <h:outputText id="usedMemory" value="#{s.info.usedMemory}"/>
                            <h:outputLabel for="availableMemory" value="Available Memory:" style="font-weight: bold"/>
                            <h:outputText id="availableMemory" value="#{s.info.availableMemory}"/>
                            <h:outputLabel for="cpuTime" value="Cpu Time(khz):" style="font-weight: bold"/>
                            <h:outputText id="cpuTime" value="#{s.info.cpuTime}"/>
                            <h:outputLabel for="activeTransactions" value="Active Transactions:" style="font-weight: bold"/>
                            <h:outputText id="activeTransactions" value="#{s.info.activeTransactions}"/>
                            <h:outputLabel for="commitedTransactions" value="Commited Transactions:" style="font-weight: bold"/>
                            <h:outputText id="commitedTransactions" value="#{s.info.commitedTransactions}"/>
                            <h:outputLabel for="rollbackTransactions" value="Rollback Transactions:" style="font-weight: bold"/>
                            <h:outputText id="rollbackTransactions" value="#{s.info.rollbackTransactions}"/>
                            <h:outputLabel for="activeThreads" value="Active Threads:" style="font-weight: bold"/>
                            <h:outputText id="activeThreads" value="#{s.info.activeThreads}"/>
                        </h:panelGrid>
                    </p:panel>
                 </ui:repeat>
                </h:panelGrid>
        </p:outputPanel>
        
        <p:dialog header="Adding Server" widgetVar="blocker" modal="true" showEffect="fade" hideEffect="clip" height="100px" width="250px">
            <br/>
            <center>
                <h:graphicImage library="images" name="ajax-loader.gif"/>
            </center>
        </p:dialog>
    </ui:define>

</ui:composition>